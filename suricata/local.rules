
# 1. Detect Nmap Service Version Detection (-sV)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"LOCAL NMAP Service Scan Detected"; flow:to_server,established; content:"|00 00|"; depth:2; sid:1000001; rev:1;)

# 2. Detect Hydra SSH Brute Force (High Sensitivity)
# Alerts if more than 5 connections are attempted from one IP to port 22 in 10 seconds
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"LOCAL SSH Brute Force (Hydra) Attempt"; flow:to_server; flags:S; threshold:type threshold, track by_src, count 5, seconds 10; sid:1000002; rev:1;)

# 3. Detect ICMP Ping Sweep (Nmap -sn)
alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"LOCAL NMAP Ping Sweep Scan"; itype:8; threshold:type threshold, track by_src, count 10, seconds 10; sid:1000003; rev:1;)
